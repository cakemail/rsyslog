# Generated by Chef
# Local modifications will be overwritten

<% if node['rsyslog']['use_relp'] -%>
$ModLoad imrelp
$InputRELPServerRun <%= node['rsyslog']['relp_port'] %>
<% end -%>
$DirGroup <%= node['rsyslog']['group'] %>
$DirCreateMode 0755
$FileGroup <%= node['rsyslog']['group'] %>


$template MainQueue,"<%= node['rsyslog']['log_dir'] %>/mainqueue.log"
$template precise,"%syslogpriority%,%syslogfacility%,%timegenerated%,%HOSTNAME%,%syslogtag%,%msg%\n"

$ActionFileDefaultTemplate precise

local3.info             ?MainQueue
& ~
local3.crit             ?MainQueue
& ~
local3.warn             ?MainQueue
& ~

auth,authpriv.*         ?MainQueue
*.*;auth,authpriv.none  -?MainQueue
cron.*                  ?MainQueue
daemon.*                -?MainQueue
kern.*                  -?MainQueue
lpr.*                   -?MainQueue
mail.*                  -?MainQueue
user.*                  -?MainQueue

mail.info               -?MainQueue
mail.warn               ?MainQueue
mail.err                ?MainQueue

news.crit               ?MainQueue
news.err                ?MainQueue
news.notice             -?MainQueue


*.=debug;\
  auth,authpriv.none;\
  news.none;mail.none   -?MainQueue

*.=info;*.=notice;*.=warn;\
  auth,authpriv.none;\
  cron,daemon.none;\
  mail,news.none        -?MainQueue

#
# Stop processing of all non-local messages. You can process remote messages
# on levels less than 35.
#
:fromhost-ip,!isequal,"127.0.0.1" ~
